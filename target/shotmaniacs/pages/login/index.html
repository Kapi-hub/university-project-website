<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Admin and Crew Login Page</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link href="./../general.css" rel="stylesheet">
    <link href="./../admin/admin.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/kiona-2" rel="stylesheet">


    <script>
        function submitForm() {

            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const XHR = new XMLHttpRequest();

            XHR.open('POST', 'http://localhost:8080/shotmaniacs_war/api/login/submit-form');

            XHR.setRequestHeader('Content-Type', 'application/json');


            XHR.onload = function () {
                if (XHR.status === 200) {
                    const cookies = XHR.getResponseHeader('Set-Cookie');
                    const accountId = cookies.split(',')[1].split(';')[0].split('=')[1];
                    const sessionId = cookies.split(',')[0].split(';')[0].split('=')[1];
                    // store cookies
                    document.cookie = `accountId=${accountId}`;
                    document.cookie = `sessionId=${sessionId}`;
                    alert(XHR.responseURL)
                    window.location.href = XHR.responseURL;
                } else if (XHR.status === 401) {
                    alert('Wrong username or password');
                } else {
                    alert('Something went wrong. Response status: ' + XHR.status);
                }
            }


            XHR.send(JSON.stringify({
                username: username,
                password: password
            }));
        }
    </script>
</head>
<body>
<nav>
    <div class="navbar">
        <div class="container">
            <a class="navbar-brand" href="../admin/mainPage/index.html">
                <img src="./../../img/Shotmaniacs_Logo_Black_ZT.png" alt="Shotmaniacs" width="50" height="90">
            </a>
            <div class="navbar-text mx-auto">
                <span class="navbar-text">Admin and Crew Member Login Portal</span>
            </div>
        </div>
    </div>
</nav>

<div class="container">
    <div class="mb-3">
        <label for="username" class="form-label">Username or email address:</label>
        <input type="text" class="form-control" id="username" placeholder="name@example.com"
               style="font-family: 'Roboto Thin',sans-serif !important;">

        <label for="password" class="form-label">Password:</label>
        <input type="password" class="form-control" id="password" placeholder="The password for your account"
               style="font-family: 'Roboto Thin',sans-serif !important;">

        <div class="mt-3">
            <button class="btn btn-primary login-btn" onclick="submitForm()">Login</button>
        </div>
    </div>
</div>
</body>
</html>